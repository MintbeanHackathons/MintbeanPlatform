upstream docker-frontend {
  # upstream server domain is the same as the service's name inside docker-compose.yml
  # upstream server port is the same as the exposed port inside docker-compose.yml
  server frontend:3001;
}

upstream docker-backend {
  # upstream server domain is the same as the service's name inside docker-compose.yml
  # upstream server port is the same as the exposed port inside docker-compose.yml
  server backend:3002;
}

upstream docker-keycloak {
  # upstream server domain is the same as the service's name inside docker-compose.yml
  # upstream server port is the same as the exposed port inside docker-compose.yml
  server keycloak:8080;
}

server {
  # server name here needs to be added to your Hostsfile
  server_name auth.localhost;
  listen 3000;

  location / {
    proxy_pass http://docker-keycloak;
  }
}

server {
  # server name here needs to be added to your Hostsfile
  server_name localhost;
  listen 3000;

  location /api/v1 {
    proxy_pass http://docker-backend;
  }

  location / {
    proxy_pass http://docker-frontend;
  }

  # listen 443 ssl; # managed by Certbot
  # ssl_certificate /etc/letsencrypt/live/staging.mintbean.io/fullchain.pem; # managed by Certbot
  # ssl_certificate_key /etc/letsencrypt/live/staging.mintbean.io/privkey.pem; # managed by Certbot
  # include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
  # ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}
